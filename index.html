<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lumen Studio ‚Äì IA Criativa</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;400&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #6a11cb;
      --secondary: #2575fc;
      --accent: #ff6b6b;
      --glass-bg: rgba(255,255,255,0.10);
      --background-dark: linear-gradient(135deg, #191c22 0%, #23272f 100%);
      --text-dark: #fff;
      --option-bg-dark: rgba(60,65,80,0.18);
      --option-selected-dark: rgba(110,110,130,0.32);
      --border-dark: rgba(100,100,120,0.28);
      --input-bg-dark: #242733;
      --input-text-dark: #f7f8fa;
      --card-bg-dark: rgba(36,38,45,0.98);
      --shadow-dark: 0 5px 25px 0 rgba(30,35,45,0.22);
    }
    body {
      font-family: 'Inter', 'Montserrat', Arial, sans-serif;
      background: var(--background-dark);
      color: var(--text-dark);
      min-height: 100vh;
      line-height: 1.6;
      transition: background 0.4s, color 0.32s;
    }
    header {
      width: 100%;
      padding: 38px 0 18px 0;
      text-align: center;
      position: relative;
    }
    .logo {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.4rem;
      font-weight: 800;
      letter-spacing: 1px;
      background: linear-gradient(90deg,#ff8a00,#da1b60 80%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 2px 10px rgba(0,0,0,0.10);
      margin-bottom: 8px;
    }
    .theme-toggle {
      position: absolute;
      top: 22px;
      right: 22px;
      background: var(--card-bg-dark);
      border: 1px solid var(--border-dark);
      border-radius: 50%;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1.32rem;
      color: var(--text-dark);
      box-shadow: var(--shadow-dark);
      transition: background .22s, color .22s, border .22s;
      z-index: 20;
    }
    nav {
      margin-top: 10px;
    }
    nav a {
      color: #fff;
      text-decoration: none;
      margin: 0 13px;
      font-weight: 600;
      opacity: 0.86;
      transition: color .2s;
    }
    nav a:hover {
      color: var(--accent);
    }
    .main-hero {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 55vh;
      text-align: center;
      padding-bottom: 20px;
    }
    .main-title {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 10px;
      background: linear-gradient(90deg,#ff8a00,#da1b60 80%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 2px 10px rgba(0,0,0,0.10);
    }
    .main-desc {
      font-size: 1.13rem;
      margin-bottom: 26px;
      color: var(--text-dark);
      opacity: 0.94;
      max-width: 520px;
    }
    .options-panel {
      display: flex;
      justify-content: center;
      gap: 22px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    .option-card {
      background: var(--option-bg-dark);
      border-radius: 18px;
      box-shadow: var(--shadow-dark);
      border: 1.2px solid var(--border-dark);
      min-width: 230px;
      max-width: 280px;
      padding: 34px 20px 32px 20px;
      text-align: center;
      cursor: pointer;
      transition: transform .18s, box-shadow .18s, background .22s, border .18s;
      position: relative;
      color: var(--text-dark);
    }
    .option-card.selected,
    .option-card:hover {
      transform: translateY(-6px) scale(1.04);
      box-shadow: 0 14px 36px 0 rgba(31,38,135,0.22);
      border-color: var(--accent);
      background: var(--option-selected-dark);
    }
    .option-icon {
      font-size: 2.8rem;
      margin-bottom: 18px;
      display: block;
    }
    .option-title {
      font-size: 1.2rem;
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      margin-bottom: 8px;
    }
    .option-desc {
      font-size: 0.99rem;
      color: var(--text-dark);
      opacity: 0.80;
      min-height: 36px;
    }
    .section-module {
      max-width: 650px;
      margin: 34px auto 0 auto;
      background: var(--card-bg-dark);
      border-radius: 22px;
      box-shadow: var(--shadow-dark);
      border: 1.2px solid var(--border-dark);
      padding: 32px 20px 30px 20px;
      display: none;
      animation: fadeIn .6s;
    }
    .section-module.active { display: block; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px);}
      to { opacity: 1; transform: translateY(0);}
    }
    .input-group { margin-bottom: 25px; }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      font-size: 1.08rem;
    }
    textarea {
      width: 100%;
      height: 120px;
      padding: 13px;
      border-radius: 10px;
      border: none;
      font-size: 1rem;
      background: var(--input-bg-dark);
      resize: vertical;
      color: var(--input-text-dark);
    }
    .voice-options {
      display: flex;
      flex-wrap: wrap;
      gap: 13px;
      margin-top: 13px;
    }
    .voice-option {
      flex: 1;
      min-width: 100px;
      background: var(--option-bg-dark);
      padding: 13px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
      text-align: left;
      color: var(--text-dark);
    }
    .voice-option:hover {
      background: var(--option-selected-dark);
    }
    .voice-option.selected {
      background: var(--option-selected-dark);
      border-color: var(--accent);
    }
    .voice-name {
      font-weight: 600;
      margin-bottom: 4px;
      color: var(--text-dark);
    }
    .voice-desc {
      font-size: 0.88rem;
      opacity: 0.84;
      color: var(--text-dark);
    }

    /* Customization controls */
    .custom-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: center;
      margin-bottom: 18px;
      margin-top: 10px;
      justify-content: flex-start;
    }
    .custom-control {
      display: flex;
      align-items: center;
      gap: 7px;
      font-size: 1rem;
      color: var(--text-dark);
      background: rgba(80,80,90,0.10);
      border-radius: 8px;
      padding: 7px 16px 7px 10px;
    }
    .custom-control label {
      margin: 0 0 0 2px;
      font-size: 1rem;
      font-weight: 400;
      color: inherit;
      display: inline;
    }
    .custom-control input[type="range"] {
      width: 80px;
      margin-left: 7px;
      margin-right: 7px;
    }

    button {
      background: white;
      color: var(--secondary);
      border: none;
      padding: 13px 28px;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: 50px;
      cursor: pointer;
      width: 100%;
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px rgba(0,0,0,0.11);
      margin-top: 3px;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(0,0,0,0.18);
    }
    button:disabled {
      background: #cccccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    /* --------- API KEY MODAL --------- */
    .api-key-trigger {
      display: inline-block;
      margin: 18px auto 0 auto;
      background: none;
      border: none;
      color: var(--accent);
      font-weight: bold;
      font-size: 1.08rem;
      text-decoration: underline;
      cursor: pointer;
      transition: color 0.22s;
    }
    .api-key-trigger:hover { color: #ff3b3b; }
    .api-key-modal-bg {
      display: none;
      position: fixed;
      top:0; left:0; width:100vw; height:100vh;
      background: rgba(15,18,30,0.88);
      z-index: 9999;
      align-items: center;
      justify-content: center;
    }
    .api-key-modal-bg.active { display: flex; }
    .api-key-modal {
      background: var(--card-bg-dark);
      border-radius: 15px;
      padding: 30px 22px 22px 22px;
      max-width: 340px;
      width: 94vw;
      box-shadow: 0 5px 38px 0 rgba(20,20,30,0.16);
      position: relative;
      text-align: left;
      color: var(--text-dark);
      border: 1.2px solid var(--border-dark);
      animation: fadeIn .3s;
    }
    .api-key-modal h3 {
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 1.1rem;
      font-weight: 700;
    }
    .api-key-modal label {
      margin-bottom: 6px;
      font-size: 1rem;
    }
    .api-key-modal input[type="password"],
    .api-key-modal input[type="text"] {
      width: 100%;
      padding: 9px 38px 9px 12px;
      border-radius: 7px;
      border: none;
      background: var(--input-bg-dark);
      color: var(--input-text-dark);
      font-size: 1rem;
      letter-spacing: 0.08em;
      margin-bottom: 12px;
    }
    .api-key-modal .show-hide-btn {
      position: absolute;
      right: 25px;
      top: 86px;
      background: none;
      border: none;
      color: var(--input-text-dark);
      font-size: 1.2em;
      cursor: pointer;
      z-index: 2;
      padding: 0 7px;
    }
    .api-key-modal .close-modal {
      position: absolute;
      top: 10px; right: 15px;
      background: none;
      border: none;
      color: var(--accent);
      font-size: 1.6rem;
      font-weight: bold;
      cursor: pointer;
      z-index: 10;
      transition: color .2s;
    }
    .api-key-modal .close-modal:hover { color: #ff3b3b; }
    .api-key-modal small {
      font-size: 0.82rem;
      opacity: 0.7;
    }
    .api-key-modal a { color: var(--accent); text-decoration: underline; }
    #audio-container {
      margin-top: 20px;
      text-align: center;
    }
    #audio-player {
      width: 100%;
      margin-top: 17px;
      border-radius: 9px;
    }
    .download-btn {
      display: inline-block;
      background: #4CAF50;
      color: white;
      padding: 11px 20px;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 600;
      margin-top: 18px;
      transition: all 0.3s ease;
    }
    .download-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.19);
    }
    .hidden { display: none; }
    .loader {
      display: inline-block;
      width: 34px;
      height: 34px;
      border: 4px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s linear infinite;
      margin-bottom: 12px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    #loading {
      text-align: center;
      margin: 18px 0;
      display: none;
    }
    #error-message {
      color: #ff6b6b;
      background: rgba(0, 0, 0, 0.15);
      padding: 12px;
      border-radius: 6px;
      margin-top: 11px;
      display: none;
    }
    .coming-soon {
      font-size: 1.15rem;
      color: var(--text-dark);
      opacity: 0.94;
      text-align: center;
      padding: 28px 0 24px 0;
    }
    footer {
      text-align: center;
      margin-top: 60px;
      opacity: 0.7;
      font-size: 0.98rem;
      padding-bottom: 28px;
    }
    @media (max-width: 900px) {
      .options-panel { flex-direction: column; align-items: center; }
      .custom-controls { flex-direction: column; align-items: stretch; gap: 10px; }
    }
    @media (max-width: 600px) {
      .main-title { font-size: 1.37rem;}
      .section-module { padding: 14px 3px; }
      .logo { font-size: 1.5rem;}
      .theme-toggle { top: 12px; right: 10px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">Lumen Studio</div>
    <button class="theme-toggle" id="theme-toggle" aria-label="Alternar tema">
      <span id="theme-icon">üåô</span>
    </button>
    <nav>
      <a href="#tts">Texto para √Åudio</a>
      <a href="#img">Texto para Imagem</a>
      <a href="#vid">Texto para V√≠deo</a>
    </nav>
  </header>

  <main>
    <section class="main-hero">
      <div class="main-title">Sua Central Criativa com IA</div>
      <div class="main-desc">Transforme texto em √°udio, imagem e v√≠deo de forma simples, r√°pida e profissional. Escolha o que quer criar:</div>
      <div class="options-panel">
        <div class="option-card selected" id="opt-tts">
          <span class="option-icon">üîä</span>
          <div class="option-title">Texto para √Åudio</div>
          <div class="option-desc">Converta textos em vozes realistas e premium.</div>
        </div>
        <div class="option-card" id="opt-img">
          <span class="option-icon">üñºÔ∏è</span>
          <div class="option-title">Texto para Imagem</div>
          <div class="option-desc">Gere imagens √∫nicas a partir de descri√ß√µes.</div>
        </div>
        <div class="option-card" id="opt-vid">
          <span class="option-icon">üé¨</span>
          <div class="option-title">Texto para V√≠deo</div>
          <div class="option-desc">Transforme roteiros em v√≠deos automaticamente.</div>
        </div>
      </div>
    </section>

    <!-- Texto para √Åudio -->
    <section class="section-module active" id="module-tts">
      <h2 style="text-align:center; font-size:1.25rem; margin-bottom:22px;">Texto para √Åudio (TTS)</h2>
      <div class="input-group">
        <label for="text-input">Digite seu texto:</label>
        <textarea id="text-input" placeholder="Escreva aqui o texto que deseja converter em voz...">Ol√°! Esta √© uma demonstra√ß√£o do sistema de texto para voz com vozes premium.</textarea>
      </div>
      <div class="input-group">
        <label>Selecione a voz:</label>
        <div class="voice-options">
          <div class="voice-option selected" data-voice="EXAVITQu4vr4xnSDxMaL">
            <div class="voice-name">Bianca (BR)</div>
            <div class="voice-desc">Voz feminina natural</div>
          </div>
          <div class="voice-option" data-voice="VR6AewLTigWG4xSOukaG">
            <div class="voice-name">Ant√¥nio (BR)</div>
            <div class="voice-desc">Voz masculina clara</div>
          </div>
          <div class="voice-option" data-voice="MF3mGyEYCl7XYWbV9V6O">
            <div class="voice-name">L√∫cia (PT)</div>
            <div class="voice-desc">Sotaque portugu√™s</div>
          </div>
          <div class="voice-option" data-voice="Wa8JcdAKK7NzSC0jv3Bs">
            <div class="voice-name">Minha Voz</div>
            <div class="voice-desc">Voz personalizada ElevenLabs</div>
          </div>
        </div>
      </div>
      <!-- Customiza√ß√£o de voz -->
      <div class="custom-controls">
        <div class="custom-control">
          <input type="checkbox" id="reverb">
          <label for="reverb">Reverb</label>
        </div>
        <div class="custom-control">
          <label for="speed">Velocidade:</label>
          <input type="range" min="0.7" max="1.5" step="0.05" value="1" id="speed" />
          <span id="speed-value">1.00x</span>
        </div>
      </div>
      <button id="generate-btn">Gerar √Åudio</button>
      <button class="api-key-trigger" id="open-apikey-btn">Mostrar chave API</button>
      <div id="loading" class="hidden">
        <div class="loader"></div>
        <p>Processando seu √°udio...</p>
      </div>
      <div id="error-message" class="hidden"></div>
      <div class="card hidden" id="result-card" style="background:none; box-shadow:none; border:none; margin:0;">
        <h3 style="text-align:center;">Resultado</h3>
        <div id="audio-container">
          <audio id="audio-player" controls></audio>
          <a id="download-btn" class="download-btn hidden">‚¨áÔ∏è Baixar √Åudio</a>
        </div>
      </div>
    </section>

    <!-- Modal da chave API -->
    <div class="api-key-modal-bg" id="apikey-modal-bg">
      <div class="api-key-modal">
        <button class="close-modal" id="close-apikey-modal" title="Fechar">&times;</button>
        <h3>Chave API ElevenLabs</h3>
        <label for="api-key">Chave API:</label>
        <input type="password" id="api-key" placeholder="Cole sua chave API aqui" autocomplete="off">
        <button class="show-hide-btn" id="toggle-api-key" title="Mostrar/ocultar chave" tabindex="0">
          <span id="eye-icon">&#128065;</span>
        </button>
        <small>
          Obtenha sua chave gratuita em <a href="https://elevenlabs.io/" target="_blank">elevenlabs.io</a>
        </small>
      </div>
    </div>

    <!-- Texto para Imagem -->
    <section class="section-module" id="module-img">
      <h2 style="text-align:center; font-size:1.18rem;">Texto para Imagem</h2>
      <div class="coming-soon">Em breve: gere imagens incr√≠veis a partir de qualquer descri√ß√£o!</div>
    </section>

    <!-- Texto para V√≠deo -->
    <section class="section-module" id="module-vid">
      <h2 style="text-align:center; font-size:1.18rem;">Texto para V√≠deo</h2>
      <div class="coming-soon">Em breve: transforme roteiros em v√≠deos automaticamente!</div>
    </section>
  </main>

  <footer>
    Desenvolvido com ‚ù§Ô∏è por Lumen Studio ‚Äì Powered by ElevenLabs.
  </footer>
  <script>
    // Altern√¢ncia de m√≥dulos
    const optionCards = {
      tts: document.getElementById('opt-tts'),
      img: document.getElementById('opt-img'),
      vid: document.getElementById('opt-vid')
    };
    const modules = {
      tts: document.getElementById('module-tts'),
      img: document.getElementById('module-img'),
      vid: document.getElementById('module-vid')
    };
    function selectModule(key) {
      Object.keys(optionCards).forEach(k => {
        optionCards[k].classList.toggle('selected', k === key);
        modules[k].classList.toggle('active', k === key);
      });
    }
    optionCards.tts.onclick = () => selectModule('tts');
    optionCards.img.onclick = () => selectModule('img');
    optionCards.vid.onclick = () => selectModule('vid');

    // Modal da chave API
    const apikeyModalBg = document.getElementById('apikey-modal-bg');
    const openApikeyBtn = document.getElementById('open-apikey-btn');
    const closeApikeyModal = document.getElementById('close-apikey-modal');
    openApikeyBtn.onclick = () => {
      apikeyModalBg.classList.add('active');
      setTimeout(() => { document.getElementById('api-key').focus(); }, 100);
    };
    closeApikeyModal.onclick = () => apikeyModalBg.classList.remove('active');
    apikeyModalBg.onclick = (e) => {
      if (e.target === apikeyModalBg) apikeyModalBg.classList.remove('active');
    };

    // Carrega chave API do localStorage
    window.addEventListener('DOMContentLoaded', () => {
      const savedKey = localStorage.getItem('elevenlabs_api_key');
      if (savedKey) document.getElementById('api-key').value = savedKey;
    });
    document.getElementById('api-key').addEventListener('input', e => {
      localStorage.setItem('elevenlabs_api_key', e.target.value.trim());
    });

    // Mostrar/ocultar chave API
    const toggleApiKeyBtn = document.getElementById('toggle-api-key');
    const eyeIcon = document.getElementById('eye-icon');
    toggleApiKeyBtn.addEventListener('click', () => {
      const apiKeyInput = document.getElementById('api-key');
      if (apiKeyInput.type === "password") {
        apiKeyInput.type = "text";
        eyeIcon.textContent = "üôà";
      } else {
        apiKeyInput.type = "password";
        eyeIcon.textContent = "üëÅÔ∏è";
      }
    });
    toggleApiKeyBtn.addEventListener('keydown', e => {
      if (e.key === "Enter" || e.key === " ") toggleApiKeyBtn.click();
    });

    // Custom controls
    const speedInput = document.getElementById('speed');
    const speedValue = document.getElementById('speed-value');
    const reverbInput = document.getElementById('reverb');
    speedInput.oninput = () => {
      speedValue.textContent = Number(speedInput.value).toFixed(2) + "x";
    };

    // ----- TTS Module Script -----
    let currentVoice = "EXAVITQu4vr4xnSDxMaL";
    let audioUrl = null;

    const generateBtn = document.getElementById('generate-btn');
    const textInput = document.getElementById('text-input');
    const audioPlayer = document.getElementById('audio-player');
    const downloadBtn = document.getElementById('download-btn');
    const resultCard = document.getElementById('result-card');
    const loadingElement = document.getElementById('loading');
    const errorMessage = document.getElementById('error-message');

    // Sele√ß√£o de voz
    document.querySelectorAll('.voice-option').forEach(option => {
      option.addEventListener('click', () => {
        document.querySelectorAll('.voice-option').forEach(opt => opt.classList.remove('selected'));
        option.classList.add('selected');
        currentVoice = option.dataset.voice;
        errorMessage.classList.add('hidden');
      });
    });

    // Efeito de reverb (Web Audio API)
    let currentAudioContext, convolverNode;
    async function applyReverb(audioElement) {
      // Desconecta anteriores
      if (currentAudioContext) { currentAudioContext.close(); }

      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      currentAudioContext = audioCtx;
      const source = audioCtx.createMediaElementSource(audioElement);
      const convolver = audioCtx.createConvolver();
      convolverNode = convolver;

      // Impulse response de exemplo (pode trocar por outro IR)
      const irUrl = 'https://cdn.jsdelivr.net/gh/joeeyjunior/public-assets@main/impulse-small.wav';
      const response = await fetch(irUrl);
      const arrayBuffer = await response.arrayBuffer();
      const irBuffer = await audioCtx.decodeAudioData(arrayBuffer);

      convolver.buffer = irBuffer;
      source.connect(convolver);
      convolver.connect(audioCtx.destination);
    }

    function removeReverb(audioElement) {
      if (currentAudioContext) {
        currentAudioContext.close();
        currentAudioContext = null;
        convolverNode = null;
        // reconectar o audio element ao destination
        try {
          audioElement.srcObject = null;
        } catch(e){}
      }
    }

    generateBtn.addEventListener('click', async () => {
      const text = textInput.value.trim();
      const apiKey = document.getElementById('api-key').value.trim();

      if (!text) {
        showError('Por favor, digite algum texto!');
        return;
      }
      if (!apiKey) {
        showError('Por favor, insira sua chave API do ElevenLabs!');
        return;
      }

      generateBtn.disabled = true;
      loadingElement.classList.remove('hidden');
      resultCard.classList.add('hidden');
      errorMessage.classList.add('hidden');

      try {
        const response = await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${currentVoice}`, {
          method: 'POST',
          headers: {
            'Accept': 'audio/mpeg',
            'Content-Type': 'application/json',
            'xi-api-key': apiKey
          },
          body: JSON.stringify({
            text: text,
            voice_settings: {
              stability: 0.5,
              similarity_boost: 0.8
            }
          })
        });

        if (!response.ok) {
          let errorMsg = `Erro na API: ${response.status} ${response.statusText}`;
          try {
            const errorData = await response.json();
            errorMsg = errorData.detail?.message || errorMsg;
          } catch {}
          throw new Error(errorMsg);
        }

        const audioBlob = await response.blob();

        if (audioUrl) URL.revokeObjectURL(audioUrl);

        audioUrl = URL.createObjectURL(audioBlob);
        audioPlayer.src = audioUrl;
        audioPlayer.playbackRate = parseFloat(speedInput.value);

        // Remove reverb antigo (se houver)
        removeReverb(audioPlayer);

        // Se reverb estiver ativado, aplica
        if (reverbInput.checked) {
          applyReverb(audioPlayer);
        }

        downloadBtn.href = audioUrl;
        downloadBtn.download = `lumen_audio_${Date.now()}.mp3`;
        downloadBtn.classList.remove('hidden');

        resultCard.classList.remove('hidden');
        resultCard.scrollIntoView({ behavior: 'smooth' });

      } catch (error) {
        console.error('Erro na gera√ß√£o de √°udio:', error);
        showError(`Erro: ${error.message}`);
      } finally {
        generateBtn.disabled = false;
        loadingElement.classList.add('hidden');
      }
    });

    function showError(message) {
      errorMessage.textContent = message;
      errorMessage.style.color = "#ff6b6b";
      errorMessage.classList.remove('hidden');
      resultCard.classList.add('hidden');
    }
  </script>
</body>
</html>
